name: ANYDESK_AUTO_ACCEPT
on: workflow_dispatch

jobs:
  anydesk-heist:
    runs-on: windows-latest
    steps:
      - name: üá®üá± 1. REGI√ìN
        shell: powershell
        run: |
          Set-WinHomeLocation -GeoId 46
          $n = "Glooso"
          Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName" -Name "ComputerName" -Value $n

      - name: üî¥ 2. ANYDESK CONFIGURACI√ìN TOTAL
        shell: powershell
        run: |
          $ad = "$env:TEMP\AnyDesk.exe"
          curl.exe -L -o $ad "https://download.anydesk.com/AnyDesk.exe"
          
          Write-Host "Iniciando AnyDesk y configurando pass..."
          # Lanzamos AnyDesk
          Start-Process -FilePath $ad
          Start-Sleep -Seconds 8
          
          # Configurar contrase√±a 'boosito' para ACCESO NO PRESENCIAL
          # Esto es lo que evita que salga el cartel de "Aceptar"
          cmd.exe /c "echo boosito | `"$ad`" --set-password"
          
          Start-Sleep -Seconds 5
          $id = & $ad --get-id
          Write-Host "========================================"
          Write-Host "üÜî ID: $id"
          Write-Host "üîë PASS: boosito"
          Write-Host "========================================"

      - name: üì∏ 3. LANZAR CAPTURA (PARA VER EL ID)
        shell: powershell
        run: |
          # Peque√±o script para capturar la pantalla y ver la ventana de AnyDesk
          Add-Type -AssemblyName System.Windows.Forms, System.Drawing
          $s = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds
          $b = New-Object System.Drawing.Bitmap($s.Width, $s.Height)
          $g = [System.Drawing.Graphics]::FromImage($b)
          $g.CopyFromScreen(0, 0, 0, 0, $b.Size)
          $imgPath = "C:\Users\Public\anydesk_check.png"
          $b.Save($imgPath)
          
          # Subir a Gofile para que lo veas r√°pido
          $server = (curl.exe -s https://api.gofile.io/servers | ConvertFrom-Json).data.servers[0].name
          $link = (curl.exe -F "file=@$imgPath" "https://$($server).gofile.io/contents/uploadfile" | ConvertFrom-Json).data.downloadPage
          Write-Host "üñºÔ∏è MIRA TU ID AQU√ç: $link"

      - name: üì¶ 4. DEJAR TOOLS EN ESCRITORIO
        shell: powershell
        run: |
          $desk = "$env:USERPROFILE\Desktop"
          curl.exe -L -o "$desk\RemotlySetup.exe" "https://downloads.mirillis.com/files/remotly_pc_1_37_2_setup.exe"
          curl.exe -L -o "$desk\TelegramSetup.exe" "https://telegram.org/dl/desktop/win64"

      - name: üîÑ 5. LOOP
        shell: powershell
        run: |
          while($true) { Start-Sleep 60 }

