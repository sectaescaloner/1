name: RATA_W11_GLOOSO
on: workflow_dispatch

jobs:
  gaming-heist:
    runs-on: windows-latest
    steps:
      - name: üè∑Ô∏è 1. RENOMBRAR EQUIPO A GLOOSO
        shell: powershell
        run: |
          # Cambia el nombre del host para que no salga "runner-..."
          Rename-Computer -NewName "Glooso" -Force -ErrorAction SilentlyContinue

      - name: üì• 2. DESCARGAR REMOTLY (SOLO DESCARGA)
        shell: powershell
        run: |
          $url = "https://downloads.mirillis.com/files/remotly_pc_1_37_2_setup.exe"
          $dest = "$env:USERPROFILE\Downloads\remotly_setup.exe"
          Invoke-WebRequest -Uri $url -OutFile $dest
          Write-Host "Archivo guardado en Downloads: $dest"

      - name: üîë 3. INSTALAR RUSTDESK & PASSWORD
        shell: powershell
        run: |
          curl.exe -L -o rd.msi "https://github.com/rustdesk/rustdesk/releases/download/1.3.1/rustdesk-1.3.1-x86_64.msi"
          Start-Process msiexec.exe -ArgumentList "/i rd.msi /quiet /norestart" -Wait
          Start-Sleep -Seconds 10
          # Forzar contrase√±a √∫nica
          & "C:\Program Files\RustDesk\rustdesk.exe" --password boosito
          $id = & "C:\Program Files\RustDesk\rustdesk.exe" --get-id
          Write-Host "========================================"
          Write-Host "ID RUSTDESK: $id"
          Write-Host "PASSWORD: boosito"
          Write-Host "========================================"

      - name: üì∏ 4. CAPTURA DE PANTALLA (ID EVIDENCIA)
        shell: powershell
        run: |
          Add-Type -AssemblyName System.Windows.Forms, System.Drawing
          Start-Sleep -Seconds 5
          $screen = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds
          $bitmap = New-Object System.Drawing.Bitmap($screen.Width, $screen.Height)
          $graphics = [System.Drawing.Graphics]::FromImage($bitmap)
          $graphics.CopyFromScreen(0, 0, 0, 0, $bitmap.Size)
          $bitmap.Save("C:\Users\Public\rustdesk_id.png")
          $link = curl.exe -F "reqtype=fileupload" -F "fileToUpload=@C:\Users\Public\rustdesk_id.png" https://catbox.moe/user/api.php
          Write-Host "LINK DE LA CAPTURA: $link"

      - name: üîÑ LOOP
        run: |
          while($true) { Start-Sleep 60 }

