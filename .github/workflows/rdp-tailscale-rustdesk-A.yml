name: RATA_ULTIMATE_ANYDESK
on: workflow_dispatch

jobs:
  anydesk-heist:
    runs-on: windows-latest
    steps:
      - name: üá®üá± 1. REGI√ìN Y NOMBRE
        shell: powershell
        run: |
          Set-WinHomeLocation -GeoId 46
          $n = "Glooso"
          Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName" -Name "ComputerName" -Value $n

      - name: üî¥ 2. INSTALAR ANYDESK (ACCESO DESATENDIDO)
        shell: powershell
        run: |
          # 1. Descargar AnyDesk Oficial
          $url = "https://download.anydesk.com/AnyDesk.exe"
          $dest = "$env:TEMP\AnyDesk.exe"
          $installDir = "C:\Program Files (x86)\AnyDesk"
          
          Write-Host "Descargando AnyDesk..."
          curl.exe -L -o $dest $url
          
          # 2. Instalaci√≥n Silenciosa (Esto registra el servicio autom√°ticamente)
          Write-Host "Instalando AnyDesk..."
          & $dest --install $installDir --start-with-win --silent --create-shortcuts
          
          # Esperamos que el servicio de AnyDesk arranque
          Start-Sleep -Seconds 15
          
          # 3. Configurar Contrase√±a 'boosito' para entrar sin aceptar
          # El comando echo env√≠a la pass al pipe de configuraci√≥n
          $anydesk_exe = "$installDir\AnyDesk.exe"
          
          if (Test-Path $anydesk_exe) {
              # Seteamos la contrase√±a para acceso no supervisado
              cmd.exe /c "echo boosito | `"$anydesk_exe`" --set-password"
              
              Start-Sleep -Seconds 5
              
              # 4. Obtener el ID
              $id = & $anydesk_exe --get-id
              
              Write-Host "========================================"
              Write-Host "üÜî ID ANYDESK: $id"
              Write-Host "üîë PASSWORD: boosito"
              Write-Host "üì± APP CELULAR: Descarga 'AnyDesk Remote Control'"
              Write-Host "========================================"
          } else {
              Write-Host "‚ùå Error: AnyDesk no se instal√≥ correctamente."
          }

      - name: üì¶ 3. PREPARAR PACK (Telegram & Discord)
        shell: powershell
        run: |
          $desk = "$env:USERPROFILE\Desktop"
          
          # Discord PTB (Solo instalador en escritorio)
          curl.exe -L -o "$desk\Instalar_DiscordPTB.exe" "https://discord.com/api/downloads/distributions/app/installers/latest?channel=ptb&platform=win&arch=x64"
          
          # Telegram (Instalado silencioso pero cerrado)
          $tempTG = "$env:TEMP\tg_setup.exe"
          curl.exe -L -o $tempTG "https://telegram.org/dl/desktop/win64"
          Start-Process -FilePath $tempTG -ArgumentList "/VERYSILENT", "/DIR=C:\Telegram", "/NOICONS" -Wait
          
          # Acceso directo a Telegram
          $ws = New-Object -ComObject WScript.Shell
          $s = $ws.CreateShortcut("$desk\Telegram.lnk")
          $s.TargetPath = "C:\Telegram\Telegram.exe"
          $s.Save()

      - name: üì∏ 4. EVIDENCIA DE SEGURIDAD (Por si el ID no sale)
        shell: powershell
        run: |
          # Captura para ver el ID si el log falla
          Add-Type -AssemblyName System.Windows.Forms, System.Drawing
          $s = [System.Windows.Forms.Screen]::PrimaryScreen.Bounds
          $b = New-Object System.Drawing.Bitmap($s.Width, $s.Height)
          $g = [System.Drawing.Graphics]::FromImage($b)
          $g.CopyFromScreen(0, 0, 0, 0, $b.Size)
          $imgPath = "C:\Users\Public\anydesk_id.png"
          $b.Save($imgPath)
          
          $server = (curl.exe -s https://api.gofile.io/servers | ConvertFrom-Json).data.servers[0].name
          $link = (curl.exe -F "file=@$imgPath" "https://$($server).gofile.io/contents/uploadfile" | ConvertFrom-Json).data.downloadPage
          Write-Host "üñºÔ∏è MIRA TU ID AQU√ç SI NO SALI√ì ARRIBA: $link"

      - name: üîÑ 5. MANTENER VIVO
        shell: powershell
        run: |
          Write-Host "‚úÖ Runner Listo. Con√©ctate con AnyDesk."
          while($true) { Start-Sleep 60 }
          
